<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QR & Barcode Generator</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode/dist/JsBarcode.all.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f7fa;
      color: #333;
      max-width: 600px;
      margin: 2rem auto;
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.1);
      background-color: white;
    }

    h1 {
      text-align: center;
      margin-bottom: 2rem;
    }

    label {
      margin-top: 1rem;
      display: block;
      font-weight: bold;
    }

    input[type="text"],
    input[type="number"],
    select {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    button {
      margin-top: 2rem;
      width: 100%;
      background-color: #1d72b8;
      color: white;
      padding: 0.75rem;
      font-size: 1rem;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #155d8b;
    }

    .options {
      margin-top: 1rem;
    }

    .output {
      text-align: center;
      margin-top: 2rem;
    }

    .error {
      color: red;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>QR & Barcode Generator</h1>

  <label>
    Code Type:
    <select id="codeType">
      <option value="">-- Select --</option>
      <option value="qr">QR Code</option>
      <option value="barcode">Barcode</option>
    </select>
  </label>

  <label id="inputLabel">
    Text or Link:
    <input type="text" id="inputText" placeholder="e.g. https://example.com" />
  </label>

  <!-- QR Options -->
  <div id="qrOptions" class="options" style="display:none;">
    <label>
      Size (px):
      <input type="number" id="qrSize" value="200" min="100" />
    </label>
    <label>
      Error Correction:
      <select id="qrError">
        <option value="L">L (Low)</option>
        <option value="M">M (Medium)</option>
        <option value="Q">Q (Quartile)</option>
        <option value="H">H (High)</option>
      </select>
    </label>
  </div>

  <!-- Barcode Options -->
  <div id="barcodeOptions" class="options" style="display:none;">
    <label>
      Barcode Standard:
      <select id="barcodeType">
        <option value="EAN13">EAN-13</option>
        <option value="CODE128">Code 128</option>
        <option value="UPC">UPC-A</option>
      </select>
    </label>
  </div>

  <button onclick="generate()">Generate</button>

  <div class="output" id="output"></div>
  <div class="error" id="error"></div>

  <script>
    const codeTypeSelect = document.getElementById('codeType');
    const qrOptions = document.getElementById('qrOptions');
    const barcodeOptions = document.getElementById('barcodeOptions');
    const output = document.getElementById('output');
    const error = document.getElementById('error');
    const inputLabel = document.getElementById('inputLabel');
    const inputText = document.getElementById('inputText');

    codeTypeSelect.addEventListener('change', () => {
      const type = codeTypeSelect.value;
      qrOptions.style.display = type === 'qr' ? 'block' : 'none';
      barcodeOptions.style.display = type === 'barcode' ? 'block' : 'none';
      inputLabel.innerText = type === 'barcode'
        ? 'Data (digits only for EAN-13/UPC):'
        : 'Text or Link:';
      inputLabel.appendChild(inputText); // Keep input in DOM
      inputText.placeholder = type === 'barcode' ? 'e.g. 123456789012' : 'e.g. https://example.com';
      output.innerHTML = '';
      error.innerText = '';
    });

    function calculateEAN13CheckDigit(data) {
      if (!/^\d{12}$/.test(data)) return data;
      const sum = data.split('').reduce((acc, digit, idx) =>
        acc + parseInt(digit) * (idx % 2 === 0 ? 1 : 3), 0);
      const check = (10 - (sum % 10)) % 10;
      return data + check;
    }

    function generate() {
      const input = inputText.value.trim();
      const type = codeTypeSelect.value;
      output.innerHTML = '';
      error.innerText = '';

      if (!input) {
        error.innerText = 'Please enter valid input.';
        return;
      }

      if (type === 'qr') {
        const size = parseInt(document.getElementById('qrSize').value);
        const ec = document.getElementById('qrError').value;
        const qrDiv = document.createElement('div');
        output.appendChild(qrDiv);
        new QRCode(qrDiv, {
          text: input,
          width: size,
          height: size,
          correctLevel: QRCode.CorrectLevel[ec]
        });
      } else if (type === 'barcode') {
        const barcodeType = document.getElementById('barcodeType').value;
        let value = input;

        if (barcodeType === 'EAN13') {
          if (!/^\d{12}$/.test(value)) {
            error.innerText = 'EAN-13 requires exactly 12 digits (check digit is auto-generated).';
            return;
          }
          value = calculateEAN13CheckDigit(value);
        }

        if (barcodeType === 'UPC') {
          if (!/^\d{11}$/.test(value)) {
            error.innerText = 'UPC-A requires exactly 11 digits (check digit is auto-generated).';
            return;
          }
          value = calculateEAN13CheckDigit('0' + value).substring(1); // Strip prepended 0
        }

        try {
          const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
          JsBarcode(svg, value, {
            format: barcodeType,
            displayValue: true,
            lineColor: '#000',
            fontSize: 18,
            width: 2,
            height: 100,
          });
          output.appendChild(svg);
        } catch (e) {
          error.innerText = 'Error generating barcode: ' + e.message;
        }
      } else {
        error.innerText = 'Please select a code type.';
      }
    }
  </script>
</body>
</html>
